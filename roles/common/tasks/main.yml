---
# file: roles/common/tasks/main.yml

- name: update all packages to the latest version
  apt: update_cache=yes cache_valid_time=3600
  when: ansible_distribution == 'Ubuntu'

- name: install Packages
  apt: pkg={{ item }} state=latest
  with_items:
    - ntp
    - curl
    - git 
    - htop 
    - build-essential
    - openjdk-7-jdk
    - python-pycurl
    - python-mysqldb
    - python-software-properties
    - mysql-common # libmysqlclient16
    - libssl0.9.8
    - libxslt1.1
    - libsasl2-modules-gssapi-mit
    - libdb4.8 # Python 2.6
  when: ansible_distribution == 'Ubuntu'

- name: Update all packages to the latest version
  apt: update_cache=yes 
  when: ansible_distribution == 'Ubuntu'

- name: Copy libmysqlclient pre-requisite
  copy: src=libmysqlclient16_5.1.58-1ubuntu5_amd64.deb dest=/tmp/libmysqlclient16_5.1.58-1ubuntu5_amd64.deb
  when: ansible_distribution == 'Ubuntu'

- name: Install libmysqlclient pre-requisite
  command: dpkg -i /tmp/libmysqlclient16_5.1.58-1ubuntu5_amd64.deb
  when: ansible_distribution == 'Ubuntu'

- name: Download python 2.6 minimal pre-requisite
  command: wget -O /tmp/python2.6-minimal_2.6.5-1ubuntu6.3_amd64.deb http://uk.archive.ubuntu.com/ubuntu/pool/main/p/python2.6/python2.6-minimal_2.6.5-1ubuntu6.3_amd64.deb
  when: ansible_distribution == 'Ubuntu'

- name: Download python 2.6 lib pre-requisite
  command: wget -O /tmp/libpython2.6_2.6.5-1ubuntu6_amd64.deb http://uk.archive.ubuntu.com/ubuntu/pool/main/p/python2.6/libpython2.6_2.6.5-1ubuntu6_amd64.deb
  when: ansible_distribution == 'Ubuntu'

- name: Download python 2.6 pre-requisite
  command: wget -O /tmp/python2.6_2.6.5-1ubuntu6.3_amd64.deb http://uk.archive.ubuntu.com/ubuntu/pool/main/p/python2.6/python2.6_2.6.5-1ubuntu6.3_amd64.deb
  when: ansible_distribution == 'Ubuntu'

#- name: Install Python 2.6 lib pre-requisite
#  command: dpkg -i /tmp/libpython2.6_2.6.5-1ubuntu6_amd64.deb
#  when: ansible_distribution == 'Ubuntu'

- name: Install Python 2.6 minimal pre-requisite
  command: dpkg -i /tmp/python2.6-minimal_2.6.5-1ubuntu6.3_amd64.deb
  when: ansible_distribution == 'Ubuntu'

- name: Install Python 2.6 pre-requisite
  command: dpkg -i /tmp/python2.6_2.6.5-1ubuntu6.3_amd64.deb
  when: ansible_distribution == 'Ubuntu'
